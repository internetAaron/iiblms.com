var learnplus=learnplus||{};!function(a){"use strict";a(function(){a("body").append('<div id="modal" class="modal fade"></div>'),a("#menu-to-edit li.menu-item").each(function(){a(this).find(".item-title").append('<span class="lp-mega-menu">'+learnplus.megamenu+"</span>")}),a("#menu-to-edit li.menu-item").on("click",".lp-mega-menu",function(b){b.preventDefault();var c=a("#modal"),d=a(this).parents("li.menu-item").find(".menu-item-data-db-id").val(),e=a(this).parents("li.menu-item").find(".menu-item-title").html();c.show().addClass("in").html('<span class="loading"> <i class="fa fa-spinner"></i></span>'),a.ajax({dataType:"json",method:"post",url:ajaxurl,data:{action:"learnplus_mega_fields",lpnonce:learnplus.nonce,menu_id:d},success:function(b){c.html('<div class="item-detail"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h3>'+e+'</h3><button type="button" class="close" data-dismiss="modal"><i class="fa fa-times"></i><span class="sr-only"></span></button></div><div class="modal-body"></div><div class="modal-footer"><a href="#" id="modal-save-menu-header" class="button button-primary menu-save">'+learnplus.savemenu+'</a><span class="refresh" style="display: none"> <i class="fa fa-refresh"></i></span></div></div></div></div>'),a("#modal").find(".modal-body").html(b.data),a("#modal").find(".modal-body").fadeIn().addClass("in");var d=c.find(".modal-content").height(),f=a(window).height(),g=(f-d)/2;c.find(".modal-content").css({"margin-top":g}),a("body").addClass("modal-open"),c.on("click","button.close",function(b){b.preventDefault(),c.fadeOut(500,function(){a("body").removeClass("modal-open"),c.removeClass("in"),c.html("")})}),a("#edit-item-mega-menu").is(":checked")?(c.find(".field-of-mega-menu").show(),c.find(".field-not-mega-menu").hide()):(c.find(".field-of-mega-menu").hide(),c.find(".field-not-mega-menu").show()),c.on("click","#edit-item-mega-menu",function(){a(this).is(":checked")?(c.find(".field-of-mega-menu").show(),c.find(".field-not-mega-menu").hide()):(c.find(".field-of-mega-menu").hide(),c.find(".field-not-mega-menu").show())}).trigger("click"),c.on("click","#modal-save-menu-header",function(b){b.preventDefault();var c=0,d=0,e=a(this).parents(".modal-content").find("#edit-item-mega-menu-width").val(),f=a(this).parents(".modal-content").find("#edit-item-mega-menu-column").val(),g=a(this).parents(".modal-content").find("#edit-item-mega-menu-content").val(),h=0,i=a(this).parents(".modal-content").find("#edit-item-mega-menu-bg_image").val(),j=a(this).parents(".modal-content").find("#edit-item-mega-menu-bg_h_position").val(),k=a(this).parents(".modal-content").find("#edit-item-mega-menu-bg_v_position").val(),l=a(this).parents(".modal-content").find("#edit-item-mega-menu-bg_repeat").val(),m=a(this).parents(".modal-content").find("#edit-item-mega-menu-bg_size").val(),n=a(this).parents(".modal-content").find("#edit-item-mega-menu-id").val();a(this).parents(".modal-content").find("#edit-item-mega-menu").is(":checked")&&(c=1),a(this).parents(".modal-content").find("#edit-item-mega-menu-hide_text").is(":checked")&&(d=1),a(this).parents(".modal-content").find("#edit-item-mega-menu-bg_color").is(":checked")&&(h=1),a(this).addClass("disabled"),a(this).next(".refresh").show(),a.ajax({dataType:"json",method:"post",url:ajaxurl,data:{action:"learnplus_mega_menu",lpnonce:learnplus.nonce,menu_id:n,hide_text:d,mega_menu:c,mega_menu_width:e,column:f,content:g,bg_color:h,bg_image:i,bg_h_position:j,bg_v_position:k,bg_repeat:l,bg_size:m},success:function(b){a("#modal-save-menu-header").removeClass("disabled"),a("#modal-save-menu-header").next(".refresh").hide()}})});var h;a("#upload-image").on("click",function(b){b.preventDefault();var c=a(this).next("input"),d=a(this).parent(),e=a(this).parent().find("#remove-image"),f=a(this);"undefined"!=typeof h&&h.close(),h=wp.media(),h.on("select",function(){var a=h.state().get("selection").toJSON(),b=a[0].url;c.val(b),d.css({"background-image":"url("+b+")"}),e.show(),f.hide()}),h.open()}),a("#remove-image").on("click",function(b){b.preventDefault();var c=a(this).prev("input"),d=a(this).parent(),e=a(this).parent().find("#upload-image"),f=a(this);c.val(""),d.removeAttr("style"),e.show(),f.hide()})}})}),a("body").on("click",".pick-icon",function(b){b.preventDefault(),a(this).next(".icons-block").slideToggle()}),a(".icon-selector").on("click","i",function(b){b.preventDefault();var c=a(this),d=c.data("icon");c.closest(".icons-block").next("input").val(d).siblings(".pick-icon").children("i").attr("class",d),c.addClass("selected").siblings(".selected").removeClass("selected")}),a(".search-icon").on("keyup",function(){var b=a(this).val(),c=a(this).siblings(".icon-selector").children();return b?void c.hide().filter(function(){return a(this).data("icon").indexOf(b)>=0}).show():void c.show()})})}(jQuery);